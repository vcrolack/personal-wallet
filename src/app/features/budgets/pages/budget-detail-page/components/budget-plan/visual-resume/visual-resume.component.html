<app-wrapper>
  <app-title level="h3" variant="lg">Resumen Visual</app-title>

  <app-carousel>
    <div id="donut-chart" *appCarouselSlide>
      <div class="w-full flex-1 flex items-center justify-center">
        @if (budgetAmountResume(); as data) {
          <app-donut-chart [chartData]="data"></app-donut-chart>
        }
      </div>

      <div class="w-full mt-6 grid grid-cols-1 gap-4">
        <div class="bg-primary-500/10 rounded-xl p-3 border border-primary-500/20">
          <app-text
            variant="body"
            [uppercase]="true"
            weight="bold"
            color="terciary"
          >
            Gasto Actual
          </app-text>
          <app-text variant="value" weight="bold" class="block truncate">
            {{
              budget().totalSpent | currency: "CLP" : "symbol-narrow" : "1.0-0"
            }}
          </app-text>
        </div>
        <div class="bg-surface-subtle/50 rounded-xl p-3 border border-border-subtle">
          <app-text variant="body" [uppercase]="true" weight="bold">
            Porcentaje
          </app-text>
          <app-text variant="value" weight="bold" class="block truncate">
            {{ budget().percentageSpent | number: "1.0-1" }}%
          </app-text>
        </div>
      </div>
    </div>

    <div id="pie-chart" *appCarouselSlide>
      <div class="w-full flex-1 flex items-center justify-center">
        @if (categoriesResume(); as data) {
          <app-pie-chart [chartData]="data"></app-pie-chart>
        }
      </div>
      <div class="mt-3 bg-surface-subtle/50 rounded-xl p-3 border border-border-subtle">
        <app-text
          variant="body"
          [uppercase]="true"
          weight="bold"
          color="terciary"
        >
          Top 3 categor√≠as
        </app-text>
        <ol>
          @for (category of topCategoriesResume(); track $index) {
            <app-text [capitalize]="true" tag="p" class="text-lg">
              <app-text variant="body" weight="bold" color="terciary"
                >{{ $index + 1 }}. </app-text
              >{{ category.categoryName }}
            </app-text>
          }
        </ol>
      </div>
    </div>

    <div id="rules-chart" *appCarouselSlide>
      <div class="w-full flex-1 flex items-center justify-center">
        @if (purposes(); as data) {
          <app-pie-chart [chartData]="data"></app-pie-chart>
        }
      </div>
      <div class="mt-3 bg-surface-subtle/50 rounded-xl p-3 border border-border-subtle">
        <app-title level="h4" variant="lg" class="mb-4">
          Regla 50/30/20
        </app-title>
        <div class="space-y-4">
          <div class="flex flex-col gap-1">
            <div class="flex flex-col">
              <app-text variant="xs" weight="medium"
                >50% Necesidades | 30% Ahorros | 20% Lujos</app-text
              >
            </div>
            <div
              class="w-full bg-surface-subtle rounded-full h-2 flex overflow-hidden"
            >
              <div class="bg-primary-500/50 h-full" style="width: 50%"></div>
              <div class="bg-success h-full" style="width: 30%"></div>
              <div class="bg-primary-500 h-full" style="width: 20%"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </app-carousel>
</app-wrapper>
