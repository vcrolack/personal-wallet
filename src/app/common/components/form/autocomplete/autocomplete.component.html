<div class="autocomplete-container flex flex-col gap-1.5 relative">
  @if (label()) {
    <label [for]="id()" class="text-sm font-medium text-content-primary">
      {{ label() }}
    </label>
  }

  <div class="relative">
    <input
      [id]="id()"
      type="text"
      [placeholder]="placeholder()"
      [value]="query()"
      [disabled]="disabled()"
      (input)="handleInput($event)"
      (blur)="handleBlur()"
      (focus)="handleFocus()"
      autocomplete="off"
      class="w-full rounded-md border border-border bg-surface-raised px-3 py-2 text-sm placeholder-content-muted transition-colors focus:border-border-focus focus:outline-none focus:ring-1 focus:ring-primary-500 disabled:cursor-not-allowed disabled:bg-surface-base disabled:text-content-muted"
    />

    @if (isOpen()) {
      <div
        class="absolute z-50 w-full mt-1 bg-surface-raised border border-border-subtle rounded-md shadow-lg max-h-60 overflow-y-auto"
      >
        <ul class="py-1">
          @for (option of filteredOptions(); track option.value) {
            <li>
              <button
                type="button"
                (click)="selectOption(option)"
                class="w-full text-left px-3 py-2 text-sm hover:bg-surface-subtle hover:text-primary-400 transition-colors"
              >
                {{ option.label }}
              </button>
            </li>
          } @empty {
            <li class="px-3 py-2 text-sm text-content-secondary">
              No se encontraron resultados
              @if (query()) {
                <button
                  type="button"
                  (click)="handleNoResultsClick()"
                  class="mt-2 w-full px-3 py-1.5 text-xs font-semibold text-primary-500 bg-primary-500/10 rounded-md hover:bg-primary-500/20 transition-colors"
                >
                  {{ noResultsActionLabel() }}
                </button>
              }
            </li>
          }
        </ul>
      </div>
    }
  </div>
</div>
